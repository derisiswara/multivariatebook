{
  "hash": "54a66417a74e77dbac395a0a851423df",
  "result": {
    "engine": "knitr",
    "markdown": "# Cluster Analysis\n\n## Metode berhirarki\n\nRef:\nhttps://rpubs.com/odenipinedo/cluster-analysis-in-R\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(readxl)\nProvinsi <- read_excel(\"Data/provinsi.xlsx\")\nProv.scaled = scale(Provinsi[,c(4:8)])\nrownames(Prov.scaled) = Provinsi$Provinsi\nhead(Prov.scaled)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               IPM         UHH        RLS         PPK       Gini\nAceh    0.20822137  0.04044611  0.7444782 -0.62264434 -0.8089350\nSumut   0.20085709 -0.39282591  1.0245728 -0.11277090 -0.6516207\nSumbar  0.36532598 -0.23835502  0.4747574  0.01481560 -1.2546590\nRiau    0.50033775  0.59428078  0.5162529  0.19012890 -0.9138112\nJambi   0.05848104  0.50762638 -0.1165536 -0.18648754 -0.6778397\nSumsel -0.21890679 -0.08765171 -0.2825356 -0.02582306  0.1349510\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## membuat dissimilarity matrix\ndprov = dist(Prov.scaled, method=\"euclidean\")\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nc.comp = hclust(dprov, method = \"complete\")\ncor(dprov , cophenetic(c.comp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7853523\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nc.sing = hclust(dprov, method = \"single\")\ncor(dprov , cophenetic(c.sing))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7905858\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nc.avrg = hclust(dprov, method = \"average\")\ncor(dprov , cophenetic(c.avrg))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8092689\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nc.ward = hclust(dprov, method = \"ward.D\")\ncor(dprov , cophenetic(c.ward))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5336018\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nc.ctrd = hclust(dprov, method = \"centroid\")\ncor(dprov , cophenetic(c.ctrd))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7700878\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(factoextra)\nfviz_dend(c.avrg, cex = 0.5, \n          main = \"Cluster Dendrogram average linkage\")\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\navg_coph <- cophenetic(c.avrg)\navg_clust <- cutree(c.avrg, k = 4)\ntable(avg_clust)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\navg_clust\n 1  2  3  4 \n26  1  1  6 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_dend(c.avrg, k = 4, \n          k_colors = \"jco\", \n          rect = T, \n          main = \"Average Linkage Cluster\")\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(clValid)\nlibrary(cluster)\n# internal measures\ninternal <- clValid(Prov.scaled, nClust = 2:6, \n                    clMethods = \"hierarchical\", \n                    validation = \"internal\", \n                    metric = \"euclidean\",\n                    method = \"average\")\nsummary(internal)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nClustering Methods:\n hierarchical \n\nCluster sizes:\n 2 3 4 5 6 \n\nValidation Measures:\n                                 2       3       4       5       6\n                                                                  \nhierarchical Connectivity   4.5246 10.3012 11.6345 18.3198 24.1508\n             Dunn           0.3637  0.3703  0.3703  0.3224  0.3592\n             Silhouette     0.4915  0.3484  0.3092  0.2567  0.3117\n\nOptimal Scores:\n\n             Score  Method       Clusters\nConnectivity 4.5246 hierarchical 2       \nDunn         0.3703 hierarchical 3       \nSilhouette   0.4915 hierarchical 2       \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_dend(c.avrg, k = 2, \n          k_colors = \"jco\", \n          rect = T, \n          main = \"Average Linkage Cluster\")\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngroup = cutree(c.avrg, k = 2)\ngroup\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Aceh     Sumut    Sumbar      Riau     Jambi    Sumsel  Bengkulu   Lampung \n        1         1         1         1         1         1         1         1 \n    Babel     Kepri       DKI     Jabar    Jateng       DIY     Jatim    Banten \n        1         1         2         1         1         2         1         1 \n     Bali       NTB       NTT    Kalbar   Kalteng    Kalsel    Kaltim   Kaltara \n        1         1         1         1         1         1         1         1 \n    Sulut   Sulteng    Sulsel    Sultra Gorontalo    Sulbar    Maluku     Malut \n        1         1         1         1         1         1         1         1 \n    Pabar     Papua \n        1         1 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_cluster(list(data = Prov.scaled, \n                  cluster = group)) + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprcomp(Prov.scaled)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviations (1, .., p=5):\n[1] 1.7653705 1.0227284 0.7270850 0.5299864 0.1671984\n\nRotation (n x k) = (5 x 5):\n            PC1         PC2          PC3           PC4         PC5\nIPM  -0.5601680 -0.05311199 -0.005227509 -0.0006949187 -0.82665781\nUHH  -0.4513030  0.05646383 -0.811065327  0.2024129889  0.30714735\nRLS  -0.4591728 -0.33781331  0.497619343  0.5648220282  0.32923179\nPPK  -0.5069166  0.09086739  0.227624805 -0.7546468667  0.33685862\nGini -0.1213811  0.93360390  0.206658283  0.2655422416  0.02073819\n```\n\n\n:::\n:::\n\n\n## Metode tidak berhirarki - kmeans\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_nbclust(Prov.scaled, kmeans, method = \"wss\")\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_nbclust(Prov.scaled, kmeans, method = \"silhouette\")\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(1)\nkm = kmeans(Prov.scaled, centers=4)\nkm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nK-means clustering with 4 clusters of sizes 5, 7, 16, 6\n\nCluster means:\n          IPM        UHH        RLS         PPK       Gini\n1  1.67223995  1.1202353  1.3689855  1.75840321  0.6331131\n2  0.22785944  0.6620973 -0.1491572  0.09292014  0.9739608\n3 -0.08819085 -0.1001318  0.1246391 -0.24567350 -0.7991029\n4 -1.42419372 -1.4389581 -1.2991755 -0.91861351  0.4670591\n\nClustering vector:\n     Aceh     Sumut    Sumbar      Riau     Jambi    Sumsel  Bengkulu   Lampung \n        3         3         3         3         3         3         3         3 \n    Babel     Kepri       DKI     Jabar    Jateng       DIY     Jatim    Banten \n        3         1         1         2         2         1         2         2 \n     Bali       NTB       NTT    Kalbar   Kalteng    Kalsel    Kaltim   Kaltara \n        1         4         4         3         3         3         1         3 \n    Sulut   Sulteng    Sulsel    Sultra Gorontalo    Sulbar    Maluku     Malut \n        2         3         2         2         4         4         3         3 \n    Pabar     Papua \n        4         4 \n\nWithin cluster sum of squares by cluster:\n[1] 17.054859  7.933134 22.111511  7.711994\n (between_SS / total_SS =  66.8 %)\n\nAvailable components:\n\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"      \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_cluster(list(data = Prov.scaled, cluster = km$cluster)) + theme_minimal()\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=768}\n:::\n:::\n\n",
    "supporting": [
      "05-Bab5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
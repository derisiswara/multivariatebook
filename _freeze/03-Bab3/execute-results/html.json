{
  "hash": "cc4cc52607a89d1bd10be55c21f6d618",
  "result": {
    "engine": "knitr",
    "markdown": "# Logistic Regression \n\n## Regresi Logistik Biner\n\n### Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncredit <- read.csv(\"Data/credit.csv\")\nhead(credit[,1:5],10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   creditability account.balance duration credit.amount saving.balance\n1              1               1       18          1049              1\n2              1               1        9          2799              1\n3              1               2       12           841              2\n4              1               1       12          2122              1\n5              1               1       12          2171              1\n6              1               1       10          2241              1\n7              1               1        8          3398              1\n8              1               1        6          1361              1\n9              1               4       18          1098              1\n10             1               2       24          3758              3\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstr(credit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t1000 obs. of  14 variables:\n $ creditability   : int  1 1 1 1 1 1 1 1 1 1 ...\n $ account.balance : int  1 1 2 1 1 1 1 1 4 2 ...\n $ duration        : int  18 9 12 12 12 10 8 6 18 24 ...\n $ credit.amount   : int  1049 2799 841 2122 2171 2241 3398 1361 1098 3758 ...\n $ saving.balance  : int  1 1 2 1 1 1 1 1 1 3 ...\n $ employment.year : int  2 3 4 3 3 2 4 2 1 1 ...\n $ installment.rate: int  4 2 2 3 4 1 1 2 4 1 ...\n $ marital.status  : int  2 3 2 3 3 3 3 3 2 2 ...\n $ duration.address: int  4 2 4 2 4 3 4 4 4 4 ...\n $ age             : int  21 36 23 39 38 48 39 40 65 23 ...\n $ dependents      : int  1 2 1 2 1 2 1 2 1 1 ...\n $ number.of.credit: int  1 2 1 2 2 2 2 1 2 1 ...\n $ occupation      : int  3 3 2 2 2 2 2 2 1 1 ...\n $ previous.credit : int  4 4 2 4 4 4 4 4 4 2 ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\ncredit <- credit %>% mutate(across(-c(duration,\n                            credit.amount,\n                            age),as.factor))\nstr(credit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t1000 obs. of  14 variables:\n $ creditability   : Factor w/ 2 levels \"0\",\"1\": 2 2 2 2 2 2 2 2 2 2 ...\n $ account.balance : Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 1 1 2 1 1 1 1 1 4 2 ...\n $ duration        : int  18 9 12 12 12 10 8 6 18 24 ...\n $ credit.amount   : int  1049 2799 841 2122 2171 2241 3398 1361 1098 3758 ...\n $ saving.balance  : Factor w/ 5 levels \"1\",\"2\",\"3\",\"4\",..: 1 1 2 1 1 1 1 1 1 3 ...\n $ employment.year : Factor w/ 5 levels \"1\",\"2\",\"3\",\"4\",..: 2 3 4 3 3 2 4 2 1 1 ...\n $ installment.rate: Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 4 2 2 3 4 1 1 2 4 1 ...\n $ marital.status  : Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 2 3 2 3 3 3 3 3 2 2 ...\n $ duration.address: Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 4 2 4 2 4 3 4 4 4 4 ...\n $ age             : int  21 36 23 39 38 48 39 40 65 23 ...\n $ dependents      : Factor w/ 2 levels \"1\",\"2\": 1 2 1 2 1 2 1 2 1 1 ...\n $ number.of.credit: Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 1 2 1 2 2 2 2 1 2 1 ...\n $ occupation      : Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 3 3 2 2 2 2 2 2 1 1 ...\n $ previous.credit : Factor w/ 5 levels \"0\",\"1\",\"2\",\"3\",..: 5 5 3 5 5 5 5 5 5 3 ...\n```\n\n\n:::\n:::\n\n\n\n### Pemodelan\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlogreg1 <- glm(creditability~.,data=credit,family = \"binomial\")\nsummary(logreg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = creditability ~ ., family = \"binomial\", data = credit)\n\nCoefficients:\n                    Estimate Std. Error z value Pr(>|z|)    \n(Intercept)        2.990e-01  8.942e-01   0.334 0.738097    \naccount.balance2   4.346e-01  2.013e-01   2.159 0.030852 *  \naccount.balance3   9.490e-01  3.602e-01   2.635 0.008421 ** \naccount.balance4   1.804e+00  2.222e-01   8.119 4.69e-16 ***\nduration          -2.705e-02  8.818e-03  -3.068 0.002156 ** \ncredit.amount     -1.025e-04  4.161e-05  -2.465 0.013718 *  \nsaving.balance2    1.293e-01  2.701e-01   0.479 0.632222    \nsaving.balance3    4.144e-01  3.987e-01   1.039 0.298644    \nsaving.balance4    1.241e+00  5.032e-01   2.467 0.013629 *  \nsaving.balance5    8.811e-01  2.463e-01   3.577 0.000347 ***\nemployment.year2  -1.432e-01  4.109e-01  -0.348 0.727561    \nemployment.year3   2.530e-01  3.957e-01   0.639 0.522582    \nemployment.year4   7.646e-01  4.258e-01   1.796 0.072572 .  \nemployment.year5   2.386e-01  3.962e-01   0.602 0.547012    \ninstallment.rate2 -2.841e-01  2.953e-01  -0.962 0.336089    \ninstallment.rate3 -5.122e-01  3.217e-01  -1.592 0.111374    \ninstallment.rate4 -9.279e-01  2.872e-01  -3.230 0.001236 ** \nmarital.status2    1.744e-01  3.742e-01   0.466 0.641255    \nmarital.status3    7.482e-01  3.670e-01   2.039 0.041468 *  \nmarital.status4    5.577e-01  4.371e-01   1.276 0.201928    \nduration.address2 -7.104e-01  2.832e-01  -2.509 0.012122 *  \nduration.address3 -5.443e-01  3.163e-01  -1.721 0.085314 .  \nduration.address4 -4.386e-01  2.762e-01  -1.588 0.112244    \nage                1.125e-02  8.468e-03   1.329 0.183990    \ndependents2       -2.607e-01  2.387e-01  -1.092 0.274669    \nnumber.of.credit2 -4.177e-01  2.315e-01  -1.805 0.071133 .  \nnumber.of.credit3 -4.131e-01  5.951e-01  -0.694 0.487625    \nnumber.of.credit4 -4.589e-01  9.908e-01  -0.463 0.643240    \noccupation2       -8.953e-02  6.276e-01  -0.143 0.886557    \noccupation3       -1.487e-01  6.048e-01  -0.246 0.805804    \noccupation4        1.276e-02  6.087e-01   0.021 0.983277    \nprevious.credit1  -3.136e-01  5.178e-01  -0.606 0.544686    \nprevious.credit2   6.063e-01  4.149e-01   1.461 0.143896    \nprevious.credit3   8.090e-01  4.531e-01   1.785 0.074205 .  \nprevious.credit4   1.511e+00  4.169e-01   3.625 0.000288 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1221.7  on 999  degrees of freedom\nResidual deviance:  956.0  on 965  degrees of freedom\nAIC: 1026\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n\n\n### Odds Ratio\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbeta = round(coef(logreg1),2)\nOR = round(exp(beta),2)\ncbind(beta, OR)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   beta   OR\n(Intercept)        0.30 1.35\naccount.balance2   0.43 1.54\naccount.balance3   0.95 2.59\naccount.balance4   1.80 6.05\nduration          -0.03 0.97\ncredit.amount      0.00 1.00\nsaving.balance2    0.13 1.14\nsaving.balance3    0.41 1.51\nsaving.balance4    1.24 3.46\nsaving.balance5    0.88 2.41\nemployment.year2  -0.14 0.87\nemployment.year3   0.25 1.28\nemployment.year4   0.76 2.14\nemployment.year5   0.24 1.27\ninstallment.rate2 -0.28 0.76\ninstallment.rate3 -0.51 0.60\ninstallment.rate4 -0.93 0.39\nmarital.status2    0.17 1.19\nmarital.status3    0.75 2.12\nmarital.status4    0.56 1.75\nduration.address2 -0.71 0.49\nduration.address3 -0.54 0.58\nduration.address4 -0.44 0.64\nage                0.01 1.01\ndependents2       -0.26 0.77\nnumber.of.credit2 -0.42 0.66\nnumber.of.credit3 -0.41 0.66\nnumber.of.credit4 -0.46 0.63\noccupation2       -0.09 0.91\noccupation3       -0.15 0.86\noccupation4        0.01 1.01\nprevious.credit1  -0.31 0.73\nprevious.credit2   0.61 1.84\nprevious.credit3   0.81 2.25\nprevious.credit4   1.51 4.53\n```\n\n\n:::\n:::\n\n\n\n### Multikolineratitas\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(car)\nvif(logreg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     GVIF Df GVIF^(1/(2*Df))\naccount.balance  1.283532  3        1.042480\nduration         1.828834  1        1.352344\ncredit.amount    2.284117  1        1.511330\nsaving.balance   1.286469  4        1.031989\nemployment.year  2.406179  4        1.116005\ninstallment.rate 1.443706  3        1.063114\nmarital.status   1.439516  3        1.062599\nduration.address 1.502426  3        1.070201\nage              1.365556  1        1.168570\ndependents       1.177252  1        1.085012\nnumber.of.credit 2.060162  3        1.128020\noccupation       1.893863  3        1.112307\nprevious.credit  2.136438  4        1.099541\n```\n\n\n:::\n:::\n\n\n### Akurasi\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npred_clas <- ifelse(logreg1$fitted.values > 0.5, 1, 0)\nconf_matrix <- table(credit$creditability, pred_clas)\nconf_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   pred_clas\n      0   1\n  0 145 155\n  1  68 632\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npaste0(\"Akurasi Model:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Akurasi Model:\"\n```\n\n\n:::\n\n```{.r .cell-code}\naccuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)\naccuracy\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.777\n```\n\n\n:::\n:::\n\n\n\n### Kebaikan Model\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#install.packages(\"performance\")\nlibrary(performance)\n#Outliers\nperformance::check_outliers(logreg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: No outliers detected.\n- Based on the following method and threshold: cook (0.8).\n- For variable: (Whole model)\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Metrik\nperformance(logreg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Indices of model performance\n\nAIC      |     AICc |      BIC | Tjur's R2 |  RMSE | Sigma | Log_loss\n---------------------------------------------------------------------\n1025.995 | 1028.609 | 1197.767 |     0.254 | 0.395 | 1.000 |    0.478\n\nAIC      | Score_log | Score_spherical |   PCP\n----------------------------------------------\n1025.995 |      -Inf |           0.001 | 0.687\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Goodness Of Fit\nperformance_hosmer(logreg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Hosmer-Lemeshow Goodness-of-Fit Test\n\n  Chi-squared: 8.472\n           df: 8    \n      p-value: 0.389\n```\n\n\n:::\n:::\n\n\n## Regresi Logistik Nominal atau Multinominal\n\n### Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(readxl)\nstudents <- read_excel(\"Data/students.xlsx\")\nhead(students,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 6\n   gender ses    prog      read write  math\n   <chr>  <chr>  <chr>    <dbl> <dbl> <dbl>\n 1 female low    vocation    34    35    41\n 2 male   middle general     34    33    41\n 3 male   high   vocation    39    39    44\n 4 male   low    vocation    37    37    42\n 5 male   middle vocation    39    31    40\n 6 female high   general     42    36    42\n 7 male   middle vocation    31    36    46\n 8 male   middle vocation    50    31    40\n 9 female middle vocation    39    41    33\n10 male   middle vocation    34    37    46\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstr(students)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [200 × 6] (S3: tbl_df/tbl/data.frame)\n $ gender: chr [1:200] \"female\" \"male\" \"male\" \"male\" ...\n $ ses   : chr [1:200] \"low\" \"middle\" \"high\" \"low\" ...\n $ prog  : chr [1:200] \"vocation\" \"general\" \"vocation\" \"vocation\" ...\n $ read  : num [1:200] 34 34 39 37 39 42 31 50 39 34 ...\n $ write : num [1:200] 35 33 39 37 31 36 36 31 41 37 ...\n $ math  : num [1:200] 41 41 44 42 40 42 46 40 33 46 ...\n```\n\n\n:::\n:::\n\n\n### Ubah jadi faktor\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\nstudents <- students %>% mutate(across(-c(read,write,math),as.factor))\nstudents$prog2 <- relevel(students$prog, ref = \"academic\")\nstr(students)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [200 × 7] (S3: tbl_df/tbl/data.frame)\n $ gender: Factor w/ 2 levels \"female\",\"male\": 1 2 2 2 2 1 2 2 1 2 ...\n $ ses   : Factor w/ 3 levels \"high\",\"low\",\"middle\": 2 3 1 2 3 1 3 3 3 3 ...\n $ prog  : Factor w/ 3 levels \"academic\",\"general\",..: 3 2 3 3 3 2 3 3 3 3 ...\n $ read  : num [1:200] 34 34 39 37 39 42 31 50 39 34 ...\n $ write : num [1:200] 35 33 39 37 31 36 36 31 41 37 ...\n $ math  : num [1:200] 41 41 44 42 40 42 46 40 33 46 ...\n $ prog2 : Factor w/ 3 levels \"academic\",\"general\",..: 3 2 3 3 3 2 3 3 3 3 ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(students$ses, students$prog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \n         academic general vocation\n  high         42       9        7\n  low          19      16       12\n  middle       44      20       31\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(students$gender, students$prog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \n         academic general vocation\n  female       58      24       27\n  male         47      21       23\n```\n\n\n:::\n:::\n\n\n### Pemodelan\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#install.packages(\"nnet\")\nlibrary(nnet)\nlogmultinom <- multinom(prog2 ~ ses + gender + write + read, data = students)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# weights:  21 (12 variable)\ninitial  value 219.722458 \niter  10 value 176.754587\nfinal  value 174.725397 \nconverged\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(logmultinom)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nmultinom(formula = prog2 ~ ses + gender + write + read, data = students)\n\nCoefficients:\n         (Intercept)    seslow sesmiddle gendermale       write        read\ngeneral     2.621831 1.0038426 0.5651588  0.1273914 -0.02860308 -0.04730781\nvocation    6.505182 0.6239396 1.1539447 -0.3105237 -0.08243508 -0.07108839\n\nStd. Errors:\n         (Intercept)    seslow sesmiddle gendermale      write       read\ngeneral     1.434514 0.5323398 0.4713812  0.4137756 0.02686316 0.02480868\nvocation    1.524572 0.6200276 0.5231819  0.4414783 0.02793343 0.02752520\n\nResidual Deviance: 349.4508 \nAIC: 373.4508 \n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nz <- summary(logmultinom)$coefficients/summary(logmultinom)$standard.errors\n# 2-tailed z test\np <- (1 - pnorm(abs(z), 0, 1)) * 2\np\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          (Intercept)     seslow  sesmiddle gendermale       write        read\ngeneral  6.759775e-02 0.05933302 0.23055043  0.7581770 0.286980200 0.056532815\nvocation 1.982164e-05 0.31426675 0.02741006  0.4818237 0.003166173 0.009804037\n```\n\n\n:::\n:::\n\n\n### Odds Ratio\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nexp(coef(logmultinom))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         (Intercept)   seslow sesmiddle gendermale     write      read\ngeneral      13.7609 2.728747  1.759727   1.135862 0.9718021 0.9537938\nvocation    668.5973 1.866266  3.170676   0.733063 0.9208712 0.9313796\n```\n\n\n:::\n:::\n\n\n### Multikolineratitas\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(car)\nvif(logmultinom)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            GVIF Df GVIF^(1/(2*Df))\nses     6.640420  2        1.605273\ngender  2.650955  1        1.628175\nwrite  66.396002  1        8.148374\nread   53.940932  1        7.344449\n```\n\n\n:::\n:::\n\n\n### Akurasi\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf <- students[,c(\"ses\",\"gender\",\"write\",\"read\")]\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#install.packages(\"caret\")\nlibrary(caret)\nprediksi <- predict(logmultinom, df, type = \"class\")\nconfusionMatrix(as.factor(prediksi), \n                students$prog2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction academic general vocation\n  academic       90      25       21\n  general         3       7        4\n  vocation       12      13       25\n\nOverall Statistics\n                                         \n               Accuracy : 0.61           \n                 95% CI : (0.5387, 0.678)\n    No Information Rate : 0.525          \n    P-Value [Acc > NIR] : 0.009485       \n                                         \n                  Kappa : 0.3094         \n                                         \n Mcnemar's Test P-Value : 1.959e-05      \n\nStatistics by Class:\n\n                     Class: academic Class: general Class: vocation\nSensitivity                   0.8571         0.1556          0.5000\nSpecificity                   0.5158         0.9548          0.8333\nPos Pred Value                0.6618         0.5000          0.5000\nNeg Pred Value                0.7656         0.7957          0.8333\nPrevalence                    0.5250         0.2250          0.2500\nDetection Rate                0.4500         0.0350          0.1250\nDetection Prevalence          0.6800         0.0700          0.2500\nBalanced Accuracy             0.6865         0.5552          0.6667\n```\n\n\n:::\n:::\n\n\n### Kebaikan Model\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlogmultinom0 <- multinom(prog2 ~ 1, data = students)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# weights:  6 (2 variable)\ninitial  value 219.722458 \nfinal  value 204.096674 \nconverged\n```\n\n\n:::\n\n```{.r .cell-code}\n#install.packages(\"lmtest\")\nlibrary(lmtest)\nlrtest(logmultinom0,logmultinom)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLikelihood ratio test\n\nModel 1: prog2 ~ 1\nModel 2: prog2 ~ ses + gender + write + read\n  #Df  LogLik Df  Chisq Pr(>Chisq)    \n1   2 -204.10                         \n2  12 -174.72 10 58.743  6.263e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n## Regresi Logistik Ordinal\n\n### Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncrash <- read.csv(\"Data/crash.csv\")\nhead(crash,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Gender Location SeatBelt Respon\n1  Female    Urban      Yes      1\n2    Male    Urban      Yes      1\n3    Male    Urban       No      1\n4  Female    Urban       No      1\n5    Male    Rural      Yes      1\n6  Female    Rural      Yes      1\n7    Male    Rural       No      1\n8  Female    Rural       No      1\n9  Female    Urban       No      3\n10 Female    Rural       No      3\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\ncrash <- crash %>% mutate(across(-c(Respon),as.factor))\nstr(crash)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t80 obs. of  4 variables:\n $ Gender  : Factor w/ 2 levels \"Female\",\"Male\": 1 2 2 1 2 1 2 1 1 1 ...\n $ Location: Factor w/ 2 levels \"Rural\",\"Urban\": 2 2 2 2 1 1 1 1 2 1 ...\n $ SeatBelt: Factor w/ 2 levels \"No\",\"Yes\": 2 2 1 1 2 2 1 1 1 1 ...\n $ Respon  : int  1 1 1 1 1 1 1 1 3 3 ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncrash$Respon <- ordered(crash$Respon, levels=c(\"1\",\"2\",\"3\",\"4\",\"5\"))\nstr(crash)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t80 obs. of  4 variables:\n $ Gender  : Factor w/ 2 levels \"Female\",\"Male\": 1 2 2 1 2 1 2 1 1 1 ...\n $ Location: Factor w/ 2 levels \"Rural\",\"Urban\": 2 2 2 2 1 1 1 1 2 1 ...\n $ SeatBelt: Factor w/ 2 levels \"No\",\"Yes\": 2 2 1 1 2 2 1 1 1 1 ...\n $ Respon  : Ord.factor w/ 5 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 1 1 1 1 3 3 ...\n```\n\n\n:::\n:::\n\n\n### Pemodelan\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#install.packages(\"MASS\")\nlibrary(MASS)\norderlog <- polr(Respon~., method='logistic',data=crash)\nsummary(orderlog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\npolr(formula = Respon ~ ., data = crash, method = \"logistic\")\n\nCoefficients:\n                 Value Std. Error t value\nGenderMale    -0.05369     0.3974 -0.1351\nLocationUrban  0.05661     0.3958  0.1430\nSeatBeltYes   -0.31102     0.3974 -0.7827\n\nIntercepts:\n    Value   Std. Error t value\n1|2 -1.5425  0.4450    -3.4664\n2|3 -0.5523  0.4060    -1.3603\n3|4  0.2649  0.3966     0.6678\n4|5  1.2472  0.4264     2.9249\n\nResidual Deviance: 256.8444 \nAIC: 270.8444 \n```\n\n\n:::\n:::\n\n\n### Odds Ratio\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nkoefisien<-coef(summary(orderlog)) \nexp(koefisien[,1])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   GenderMale LocationUrban   SeatBeltYes           1|2           2|3 \n    0.9477303     1.0582414     0.7327004     0.2138542     0.5756362 \n          3|4           4|5 \n    1.3032362     3.4805710 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# menghitung pvalue\np <- pnorm(abs(koefisien[,\"t value\"]), lower.tail = FALSE)*2\n(ctabel<-cbind(round(koefisien,2), \"pvalue\"=round(p,3))) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Value Std. Error t value pvalue\nGenderMale    -0.05       0.40   -0.14  0.893\nLocationUrban  0.06       0.40    0.14  0.886\nSeatBeltYes   -0.31       0.40   -0.78  0.434\n1|2           -1.54       0.44   -3.47  0.001\n2|3           -0.55       0.41   -1.36  0.174\n3|4            0.26       0.40    0.67  0.504\n4|5            1.25       0.43    2.92  0.003\n```\n\n\n:::\n:::\n\n\n### Multikolineratitas\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(car)\nvif(orderlog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Gender Location SeatBelt \n1.002035 1.001265 1.001814 \n```\n\n\n:::\n:::\n\n\n### Akurasi\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf <- crash[,1:3]\nprediksi <- predict(orderlog, df, type = \"class\")\nconfusionMatrix(as.factor(prediksi), \n                crash$Respon)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  1  2  3  4  5\n         1 10  8  7  7  8\n         2  0  0  0  0  0\n         3  0  0  0  0  0\n         4  0  0  0  0  0\n         5  6  8  9  9  8\n\nOverall Statistics\n                                          \n               Accuracy : 0.225           \n                 95% CI : (0.1391, 0.3321)\n    No Information Rate : 0.2             \n    P-Value [Acc > NIR] : 0.3292          \n                                          \n                  Kappa : 0.0312          \n                                          \n Mcnemar's Test P-Value : NA              \n\nStatistics by Class:\n\n                     Class: 1 Class: 2 Class: 3 Class: 4 Class: 5\nSensitivity            0.6250      0.0      0.0      0.0      0.5\nSpecificity            0.5312      1.0      1.0      1.0      0.5\nPos Pred Value         0.2500      NaN      NaN      NaN      0.2\nNeg Pred Value         0.8500      0.8      0.8      0.8      0.8\nPrevalence             0.2000      0.2      0.2      0.2      0.2\nDetection Rate         0.1250      0.0      0.0      0.0      0.1\nDetection Prevalence   0.5000      0.0      0.0      0.0      0.5\nBalanced Accuracy      0.5781      0.5      0.5      0.5      0.5\n```\n\n\n:::\n:::\n\n\n### Kebaikan Model\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\norderlog0 <-polr(Respon~1, method = \"logistic\", data = crash)\n#install.packages(\"lmtest\")\nlibrary(lmtest)\nlrtest(orderlog0,orderlog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLikelihood ratio test\n\nModel 1: Respon ~ 1\nModel 2: Respon ~ Gender + Location + SeatBelt\n  #Df  LogLik Df  Chisq Pr(>Chisq)\n1   4 -128.75                     \n2   7 -128.42  3 0.6657     0.8813\n```\n\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
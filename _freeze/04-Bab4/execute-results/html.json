{
  "hash": "78acd68ee3d24f37772966bd413f72ed",
  "result": {
    "engine": "knitr",
    "markdown": "\n# Discriminant Analysis\n\n## Analisis Diskriminan Dua Grup\n\n### Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(readxl)\npinjaman <- read_excel(\"Data/pinjaman.xlsx\")\nhead(pinjaman,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 6\n      X1    X2    X3    X4    X5     Y\n   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1    98    35    12     4     4     1\n 2    65    44     5     3     1     1\n 3    22    50     0     2     7     1\n 4    78    60    34     5     5     1\n 5    50    31     4     2     2     1\n 6    21    30     5     3     7     1\n 7    42    32    21     4    11     1\n 8    20    41    10     2     3     1\n 9    33    25     0     3     6     1\n10    57    32     8     2     5     1\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstr(pinjaman)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [32 × 6] (S3: tbl_df/tbl/data.frame)\n $ X1: num [1:32] 98 65 22 78 50 21 42 20 33 57 ...\n $ X2: num [1:32] 35 44 50 60 31 30 32 41 25 32 ...\n $ X3: num [1:32] 12 5 0 34 4 5 21 10 0 8 ...\n $ X4: num [1:32] 4 3 2 5 2 3 4 2 3 2 ...\n $ X5: num [1:32] 4 1 7 5 2 7 11 3 6 5 ...\n $ Y : num [1:32] 1 1 1 1 1 1 1 1 1 1 ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npinjaman$Y <- as.factor(pinjaman$Y)\nstr(pinjaman)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [32 × 6] (S3: tbl_df/tbl/data.frame)\n $ X1: num [1:32] 98 65 22 78 50 21 42 20 33 57 ...\n $ X2: num [1:32] 35 44 50 60 31 30 32 41 25 32 ...\n $ X3: num [1:32] 12 5 0 34 4 5 21 10 0 8 ...\n $ X4: num [1:32] 4 3 2 5 2 3 4 2 3 2 ...\n $ X5: num [1:32] 4 1 7 5 2 7 11 3 6 5 ...\n $ Y : Factor w/ 2 levels \"0\",\"1\": 2 2 2 2 2 2 2 2 2 2 ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(psych)\npairs.panels(pinjaman[1:5],\n             gap = 0,\n             bg = c(\"red\", \"green\")[pinjaman$Y],\n             pch = 21)\n```\n\n::: {.cell-output-display}\n![](04-Bab4_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n### Pemodelan Linier\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(MASS)\nmodellda1 <- lda(Y ~ X1 + X2 + X3 + X4 + X5, data=pinjaman)\nmodellda1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nlda(Y ~ X1 + X2 + X3 + X4 + X5, data = pinjaman)\n\nPrior probabilities of groups:\n     0      1 \n0.4375 0.5625 \n\nGroup means:\n        X1       X2       X3       X4       X5\n0 23.07143 26.78571 23.21429 3.428571 4.071429\n1 44.33333 34.38889 11.72222 2.888889 4.500000\n\nCoefficients of linear discriminants:\n            LD1\nX1  0.037015853\nX2 -0.004820049\nX3 -0.043555291\nX4 -0.477408359\nX5 -0.008483836\n```\n\n\n:::\n:::\n\n\n### Uji Signifikansi Fungsi Diskriminan\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm <- manova(cbind(pinjaman$X1,pinjaman$X2,pinjaman$X3,\n                  pinjaman$X4,pinjaman$X5) ~ pinjaman$Y)\nsummary(m, test = 'Wilks')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Df   Wilks approx F num Df den Df  Pr(>F)  \npinjaman$Y  1 0.62715   3.0915      5     26 0.02544 *\nResiduals  30                                         \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### Akurasi\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- predict(modellda1, pinjaman)\nldahist(data = p$x, g = pinjaman$Y)\n```\n\n::: {.cell-output-display}\n![](04-Bab4_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(caret)\nconfusionMatrix(p$class,pinjaman$Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  0  1\n         0  9  4\n         1  5 14\n                                          \n               Accuracy : 0.7188          \n                 95% CI : (0.5325, 0.8625)\n    No Information Rate : 0.5625          \n    P-Value [Acc > NIR] : 0.0523          \n                                          \n                  Kappa : 0.424           \n                                          \n Mcnemar's Test P-Value : 1.0000          \n                                          \n            Sensitivity : 0.6429          \n            Specificity : 0.7778          \n         Pos Pred Value : 0.6923          \n         Neg Pred Value : 0.7368          \n             Prevalence : 0.4375          \n         Detection Rate : 0.2812          \n   Detection Prevalence : 0.4062          \n      Balanced Accuracy : 0.7103          \n                                          \n       'Positive' Class : 0               \n                                          \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean(p$class==pinjaman$Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.71875\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#install.packages(\"klaR\")\nlibrary(klaR)\n#Partition plot\npartimat(Y~., data = pinjaman, method = \"lda\")\n```\n\n::: {.cell-output-display}\n![](04-Bab4_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npartimat(Y~., data = pinjaman, method = \"qda\")\n```\n\n::: {.cell-output-display}\n![](04-Bab4_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n### Pemodelan Quadratik\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmodellda2 <- qda(Y ~ X1 + X2 + X3 + X4 + X5, data=pinjaman)\nmodellda2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nqda(Y ~ X1 + X2 + X3 + X4 + X5, data = pinjaman)\n\nPrior probabilities of groups:\n     0      1 \n0.4375 0.5625 \n\nGroup means:\n        X1       X2       X3       X4       X5\n0 23.07143 26.78571 23.21429 3.428571 4.071429\n1 44.33333 34.38889 11.72222 2.888889 4.500000\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- predict(modellda2, pinjaman)\nmean(p$class==pinjaman$Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.84375\n```\n\n\n:::\n:::\n\n\n### Tipe Diskriminan Lainnya\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Mixture discriminant analysis - MDA\n# install.packages(\"mda\")\nlibrary(mda)\nmodellda3 <- mda(Y ~ X1 + X2 + X3 + X4 + X5, data=pinjaman)\np <- predict(modellda3, pinjaman)\nmean(p==pinjaman$Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.875\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Flexible discriminant analysis - FDA\nmodellda4 <- fda(Y ~ X1 + X2 + X3 + X4 + X5, data=pinjaman)\np <- predict(modellda4, pinjaman)\nmean(p==pinjaman$Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.71875\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Regularized discriminant analysis - RDA\nmodellda5 <- rda(Y ~ X1 + X2 + X3 + X4 + X5, data=pinjaman)\np <- predict(modellda5, pinjaman)\nmean(p$class==pinjaman$Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.71875\n```\n\n\n:::\n:::\n\n\n## Analisis Diskriminan Tiga Grup\n\n### Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata(\"iris\")\nhead(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nstr(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t150 obs. of  5 variables:\n $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(MASS)\nlda.iris <- lda(Species ~ ., iris)\nlda.iris \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nlda(Species ~ ., data = iris)\n\nPrior probabilities of groups:\n    setosa versicolor  virginica \n 0.3333333  0.3333333  0.3333333 \n\nGroup means:\n           Sepal.Length Sepal.Width Petal.Length Petal.Width\nsetosa            5.006       3.428        1.462       0.246\nversicolor        5.936       2.770        4.260       1.326\nvirginica         6.588       2.974        5.552       2.026\n\nCoefficients of linear discriminants:\n                    LD1         LD2\nSepal.Length  0.8293776 -0.02410215\nSepal.Width   1.5344731 -2.16452123\nPetal.Length -2.2012117  0.93192121\nPetal.Width  -2.8104603 -2.83918785\n\nProportion of trace:\n   LD1    LD2 \n0.9912 0.0088 \n```\n\n\n:::\n:::\n\n\n### Uji Signifikansi Fungsi Diskriminan\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm <- manova(cbind(iris$Sepal.Length,iris$Sepal.Width,iris$Petal.Length,\n                  iris$Petal.Width) ~ iris$Species)\nsummary(m, test = 'Wilks')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Df    Wilks approx F num Df den Df    Pr(>F)    \niris$Species   2 0.023439   199.15      8    288 < 2.2e-16 ***\nResiduals    147                                              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### Akurasi\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- predict(lda.iris, iris)\nldahist(data = p$x, g = iris$Species)\n```\n\n::: {.cell-output-display}\n![](04-Bab4_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(p$class,iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \n             setosa versicolor virginica\n  setosa         50          0         0\n  versicolor      0         48         1\n  virginica       0          2        49\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean(p$class==iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.98\n```\n\n\n:::\n:::\n\n\n### Visualisasi\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlda.data <- cbind(iris,  p$x)\nggplot(lda.data, aes(LD1, LD2)) +\n  geom_point(aes(color = Species)) + theme_classic()\n```\n\n::: {.cell-output-display}\n![](04-Bab4_files/figure-html/unnamed-chunk-24-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n### Pemodelan Quadratik\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nqda.iris <- qda(Species ~ ., data=iris)\nqda.iris\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nqda(Species ~ ., data = iris)\n\nPrior probabilities of groups:\n    setosa versicolor  virginica \n 0.3333333  0.3333333  0.3333333 \n\nGroup means:\n           Sepal.Length Sepal.Width Petal.Length Petal.Width\nsetosa            5.006       3.428        1.462       0.246\nversicolor        5.936       2.770        4.260       1.326\nvirginica         6.588       2.974        5.552       2.026\n```\n\n\n:::\n\n```{.r .cell-code}\np <- predict(qda.iris, iris)\nmean(p$class==iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.98\n```\n\n\n:::\n:::\n\n\n### Tipe Diskriminan Lainnya\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Mixture discriminant analysis - MDA\n# install.packages(\"mda\")\nlibrary(mda)\nmda.iris <- mda(Species ~ ., data=iris)\nmda.iris\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nmda(formula = Species ~ ., data = iris)\n\nDimension: 4 \n\nPercent Between-Group Variance Explained:\n    v1     v2     v3     v4 \n 96.14  98.47  99.89 100.00 \n\nDegrees of Freedom (per dimension): 5 \n\nTraining Misclassification Error: 0.02 ( N = 150 )\n\nDeviance: 15.249 \n```\n\n\n:::\n\n```{.r .cell-code}\np <- predict(mda.iris, iris)\nmean(p==iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.98\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Flexible discriminant analysis - FDA\nfda.iris <- fda(Species ~ ., data=iris)\nfda.iris\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nfda(formula = Species ~ ., data = iris)\n\nDimension: 2 \n\nPercent Between-Group Variance Explained:\n    v1     v2 \n 99.12 100.00 \n\nDegrees of Freedom (per dimension): 5 \n\nTraining Misclassification Error: 0.02 ( N = 150 )\n```\n\n\n:::\n\n```{.r .cell-code}\np <- predict(fda.iris, iris)\nmean(p==iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.98\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Regularized discriminant analysis - RDA\nrda.iris <- rda(Species ~ ., data=iris)\nrda.iris\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall: \nrda(formula = Species ~ ., data = iris)\n\nRegularization parameters: \n    gamma    lambda \n0.1051791 0.9596476 \n\nPrior probabilities of groups: \n    setosa versicolor  virginica \n 0.3333333  0.3333333  0.3333333 \n\nMisclassification rate: \n       apparent: 2 %\ncross-validated: 2 %\n```\n\n\n:::\n\n```{.r .cell-code}\np <- predict(rda.iris, iris)\nmean(p$class==iris$Species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.98\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "04-Bab4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
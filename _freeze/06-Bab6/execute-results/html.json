{
  "hash": "09bdd5cd6795b5dc7a56834e8b9c81b2",
  "result": {
    "engine": "knitr",
    "markdown": "\n# PCA Analysis and Biplot\n\n## PCA\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# impor data dari excel, beri nama: Provinsi\nlibrary(readxl)\nProvinsi = read_excel(\"Data/provinsi.xlsx\")\nProv.scaled = scale(Provinsi[,c(4:8)])\nround(cor(Prov.scaled),3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       IPM   UHH    RLS   PPK   Gini\nIPM  1.000 0.780  0.811 0.872  0.159\nUHH  0.780 1.000  0.447 0.581  0.153\nRLS  0.811 0.447  1.000 0.637 -0.059\nPPK  0.872 0.581  0.637 1.000  0.249\nGini 0.159 0.153 -0.059 0.249  1.000\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# PCA langkah manual\nProv.eigen = eigen(cov(Prov.scaled))\nProv.eigen\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\neigen() decomposition\n$values\n[1] 3.11653307 1.04597347 0.52865259 0.28088555 0.02795532\n\n$vectors\n           [,1]        [,2]         [,3]          [,4]        [,5]\n[1,] -0.5601680 -0.05311199  0.005227509 -0.0006949187  0.82665781\n[2,] -0.4513030  0.05646383  0.811065327  0.2024129889 -0.30714735\n[3,] -0.4591728 -0.33781331 -0.497619343  0.5648220282 -0.32923179\n[4,] -0.5069166  0.09086739 -0.227624805 -0.7546468667 -0.33685862\n[5,] -0.1213811  0.93360390 -0.206658283  0.2655422416 -0.02073819\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nProv.eigen$values\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.11653307 1.04597347 0.52865259 0.28088555 0.02795532\n```\n\n\n:::\n\n```{.r .cell-code}\nProv.eigen$values/5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.623306615 0.209194694 0.105730518 0.056177109 0.005591064\n```\n\n\n:::\n\n```{.r .cell-code}\ncumsum(Prov.eigen$values/5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6233066 0.8325013 0.9382318 0.9944089 1.0000000\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nProv.pc = as.matrix(Prov.scaled) %*% Prov.eigen$vectors\nround(Prov.pc,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        [,1]   [,2]   [,3]   [,4]   [,5]\n [1,] -0.063 -1.072 -0.028  0.684  0.141\n [2,] -0.269 -0.998 -0.667  0.411  0.001\n [3,] -0.170 -1.363 -0.172 -0.125  0.240\n [4,] -0.771 -1.003  0.373  0.025  0.016\n [5,] -0.032 -0.585  0.653 -0.002  0.008\n [6,]  0.289  0.226  0.046 -0.122 -0.055\n [7,]  0.167 -0.380 -0.246  0.160  0.149\n [8,]  0.632 -0.498  0.644 -0.115 -0.054\n [9,] -0.057 -1.798  0.675 -1.464 -0.089\n[10,] -2.171 -0.475 -1.111 -0.280 -0.100\n[11,] -5.201  0.488 -1.517 -0.455 -0.423\n[12,] -0.699  0.908  0.818  0.388 -0.141\n[13,] -0.467  0.567  1.901 -0.226 -0.064\n[14,] -3.637  1.770  0.377  0.349  0.361\n[15,] -0.211  1.726  0.527 -0.300  0.118\n[16,] -0.763  0.414 -0.365 -0.198  0.007\n[17,] -1.962  0.494  0.024 -0.719  0.052\n[18,]  1.779  0.864 -0.537 -0.824  0.322\n[19,]  2.630  0.251 -0.136  0.131  0.011\n[20,]  1.501 -0.351  1.137 -0.243 -0.049\n[21,]  0.004 -0.801  0.195 -0.277 -0.039\n[22,]  0.104 -0.191 -0.358 -0.828  0.030\n[23,] -2.225 -0.963  0.752  0.305  0.020\n[24,] -0.162 -1.278  1.179  0.698 -0.173\n[25,] -1.101  0.544 -0.154  0.823 -0.143\n[26,]  0.847 -0.438 -0.472  0.097  0.061\n[27,] -0.276  1.813 -0.105  0.254  0.105\n[28,] -0.147  0.982  0.109  0.925 -0.004\n[29,]  1.266  1.405 -0.356 -0.169  0.136\n[30,]  2.501 -0.280 -0.787 -0.540  0.062\n[31,]  0.929 -1.487 -1.397  0.735  0.080\n[32,]  1.193 -0.966 -0.326  0.739 -0.008\n[33,]  2.735  0.936 -0.533  0.218 -0.091\n[34,]  3.806  1.539 -0.145 -0.057 -0.487\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# dengan fungsi prcomp\npc = prcomp(x = Prov.scaled, center=TRUE, scale=TRUE)\nsummary(pc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nImportance of components:\n                          PC1    PC2    PC3     PC4     PC5\nStandard deviation     1.7654 1.0227 0.7271 0.52999 0.16720\nProportion of Variance 0.6233 0.2092 0.1057 0.05618 0.00559\nCumulative Proportion  0.6233 0.8325 0.9382 0.99441 1.00000\n```\n\n\n:::\n\n```{.r .cell-code}\nround(pc$x,3)#scores\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         PC1    PC2    PC3    PC4    PC5\n [1,] -0.063 -1.072  0.028  0.684 -0.141\n [2,] -0.269 -0.998  0.667  0.411 -0.001\n [3,] -0.170 -1.363  0.172 -0.125 -0.240\n [4,] -0.771 -1.003 -0.373  0.025 -0.016\n [5,] -0.032 -0.585 -0.653 -0.002 -0.008\n [6,]  0.289  0.226 -0.046 -0.122  0.055\n [7,]  0.167 -0.380  0.246  0.160 -0.149\n [8,]  0.632 -0.498 -0.644 -0.115  0.054\n [9,] -0.057 -1.798 -0.675 -1.464  0.089\n[10,] -2.171 -0.475  1.111 -0.280  0.100\n[11,] -5.201  0.488  1.517 -0.455  0.423\n[12,] -0.699  0.908 -0.818  0.388  0.141\n[13,] -0.467  0.567 -1.901 -0.226  0.064\n[14,] -3.637  1.770 -0.377  0.349 -0.361\n[15,] -0.211  1.726 -0.527 -0.300 -0.118\n[16,] -0.763  0.414  0.365 -0.198 -0.007\n[17,] -1.962  0.494 -0.024 -0.719 -0.052\n[18,]  1.779  0.864  0.537 -0.824 -0.322\n[19,]  2.630  0.251  0.136  0.131 -0.011\n[20,]  1.501 -0.351 -1.137 -0.243  0.049\n[21,]  0.004 -0.801 -0.195 -0.277  0.039\n[22,]  0.104 -0.191  0.358 -0.828 -0.030\n[23,] -2.225 -0.963 -0.752  0.305 -0.020\n[24,] -0.162 -1.278 -1.179  0.698  0.173\n[25,] -1.101  0.544  0.154  0.823  0.143\n[26,]  0.847 -0.438  0.472  0.097 -0.061\n[27,] -0.276  1.813  0.105  0.254 -0.105\n[28,] -0.147  0.982 -0.109  0.925  0.004\n[29,]  1.266  1.405  0.356 -0.169 -0.136\n[30,]  2.501 -0.280  0.787 -0.540 -0.062\n[31,]  0.929 -1.487  1.397  0.735 -0.080\n[32,]  1.193 -0.966  0.326  0.739  0.008\n[33,]  2.735  0.936  0.533  0.218  0.091\n[34,]  3.806  1.539  0.145 -0.057  0.487\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nround(pc$rotation,3)  #loadings\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        PC1    PC2    PC3    PC4    PC5\nIPM  -0.560 -0.053 -0.005 -0.001 -0.827\nUHH  -0.451  0.056 -0.811  0.202  0.307\nRLS  -0.459 -0.338  0.498  0.565  0.329\nPPK  -0.507  0.091  0.228 -0.755  0.337\nGini -0.121  0.934  0.207  0.266  0.021\n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot(pc)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=768}\n:::\n\n```{.r .cell-code}\nscreeplot(x = pc, type=\"line\", main=\"Scree plot\")\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-7-2.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# korelasi variabel asli dengan PC\ndata = cbind(Prov.pc, Prov.scaled)\nkorelasi = cor(data)\nkorelasi[6:10,1:2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                           \nIPM  -0.9889040 -0.05431915\nUHH  -0.7967169  0.05774717\nRLS  -0.8106101 -0.34549128\nPPK  -0.8948956  0.09293267\nGini -0.2142826  0.95482326\n```\n\n\n:::\n:::\n\n\n## Biplot\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# biplot\nlibrary(factoextra)\nfviz_pca(pc)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# alternatif bentuk biplot\n# install.packages(\"remotes\")\n# remotes::install_github(\"vqv/ggbiplot\")\nlibrary(ggbiplot)\nggbiplot(pc)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbiplot = ggbiplot(pcobj = pc,\n                  choices = c(1,2),\n                  obs.scale = 1, var.scale = 1,\n                  labels = row.names(Provinsi),\n                  varname.size = 3,\n                  varname.abbrev = FALSE,\n                  var.axes = TRUE,\n                  group = Provinsi$Region)\nbiplot\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbiplot2 = biplot + theme_bw() + \n  theme(legend.position=\"bottom\") + \n  labs(\n  title = \"PCA Indikator Kualitas Hidup Provinsi\", \n  color = \"Region\")\nbiplot2\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=768}\n:::\n:::\n\n",
    "supporting": [
      "06-Bab6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}